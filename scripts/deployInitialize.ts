import { ethers, artifacts } from "hardhat";
import {
  CampaignInfoFactory,
  TestUSD,
  ItemRegistry,
  GlobalParams,
  TreasuryFactory,
} from "../typechain-types";
import { getHexString } from "../lib/utils";
import { getPushLength } from "hardhat/internal/hardhat-network/stack-traces/opcodes";

async function main() {
  const [owner] = await ethers.getSigners();

  console.log("Owner address " + owner.address);

  const goalAmount = Number(500 * 1e18).toString();
  const testPreMint = Number(500 * 1e18).toString();

  const testUSDFactory = await ethers.getContractFactory("TestUSD");
  const testUSD: TestUSD = await testUSDFactory.deploy();

  await testUSD.deployed();

  console.log(`TestUSD deployed to ${testUSD.address}`);

  const mint = await testUSD.mint(owner.address, testPreMint);
  console.log(`${testPreMint} minted to user`);

  await mint.wait();

  const globalParamsFactory = await ethers.getContractFactory("GlobalParams");
  const globalParams: GlobalParams = await globalParamsFactory.deploy(
    owner.address,
    testUSD.address,
    200
  );

  await globalParams.deployed();

  console.log(`GlobalParams deployed to ${globalParams.address}`);

  const itemRegistryFactory = await ethers.getContractFactory("ItemRegistry");
  const itemRegistry: ItemRegistry = await itemRegistryFactory.deploy();

  await itemRegistry.deployed();

  console.log(`ItemRegistry deployed to ${itemRegistry.address}`);

  const campaignInfoFactoryFactory = await ethers.getContractFactory(
    "CampaignInfoFactory"
  );
  const campaignInfoFactory: CampaignInfoFactory =
    await campaignInfoFactoryFactory.deploy(globalParams.address);

  await campaignInfoFactory.deployed();

  console.log(`CampaignInfoFactory deployed to ${campaignInfoFactory.address}`);

  const treasuryFactoryFactory = await ethers.getContractFactory(
    "TreasuryFactory"
  );
  const treasuryFactory: TreasuryFactory = await treasuryFactoryFactory.deploy(
    globalParams.address,
    campaignInfoFactory.address,
    "0xcab5945253cc855eaf3d70b80fd57d6d03bf6ce326ab3763380f9b96b7384a2e"
  );

  await treasuryFactory.deployed();

  console.log(`TreasuryFactory deployed to ${treasuryFactory.address}`);

  const initialize = await campaignInfoFactory._initialize(
    treasuryFactory.address,
    globalParams.address
  );

  await initialize.wait();
  console.log("Initialized");
  const kickstarter = getHexString("Kickstarter");
  const weirdstarter = getHexString("Weirdstarter");
  const platforms = [kickstarter, weirdstarter];

  interface ICampaignData {
    launchTime: number;
    deadline: number;
    goalAmount: string;
  }

  const campaignData: ICampaignData = {
    launchTime: 1686867453,
    deadline: 1694816253,
    goalAmount: Number(500 * 1e18).toString(),
  };

  const emptyBytes32Array: string[] = [];

  const enlistPlatform = await globalParams.enlistPlatform(
    kickstarter,
    owner.address,
    200
  );

  await enlistPlatform.wait();
  console.log("Platform enlisted");

  const addBytecode = await treasuryFactory.addBytecode(kickstarter, 0, "0x61012060405234801562000011575f80fd5b5060405162003abb38038062003abb8339810160408190526200003491620001aa565b60408051602080820183525f808352835180830185528181526001600160a01b0386166080819052825460ff191690925560a0879052610100829052845163021fd35d60e31b815294519394909387938793926310fe9ae892600480830193928290030181865afa158015620000ac573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190620000d29190620001d7565b6001600160a01b0390811660e052608051604051632202a57d60e01b815260048101859052911690632202a57d90602401602060405180830381865afa1580156200011f573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190620001459190620001fa565b60c0525060069050620001598382620002b2565b506007620001688282620002b2565b5050506200017d600e6200018560201b60201c565b50506200037a565b80546001019055565b80516001600160a01b0381168114620001a5575f80fd5b919050565b5f8060408385031215620001bc575f80fd5b82519150620001ce602084016200018e565b90509250929050565b5f60208284031215620001e8575f80fd5b620001f3826200018e565b9392505050565b5f602082840312156200020b575f80fd5b5051919050565b634e487b7160e01b5f52604160045260245ffd5b600181811c908216806200023b57607f821691505b6020821081036200025a57634e487b7160e01b5f52602260045260245ffd5b50919050565b601f821115620002ad575f81815260208120601f850160051c81016020861015620002885750805b601f850160051c820191505b81811015620002a95782815560010162000294565b5050505b505050565b81516001600160401b03811115620002ce57620002ce62000212565b620002e681620002df845462000226565b8462000260565b602080601f8311600181146200031c575f8415620003045750858301515b5f19600386901b1c1916600185901b178555620002a9565b5f85815260208120601f198616915b828110156200034c578886015182559484019460019091019084016200032b565b50858210156200036a57878501515f19600388901b60f8161c191681555b5050505050600190811b01905550565b60805160a05160c05160e0516101005161363b620004805f395f50505f81816108e901528181610ac101528181610bbd01528181610eac0152818161128c0152818161177c015281816118e40152611c6101525f6102c101525f818161023d015281816106190152818161140a015281816116c3015281816118b601528181611a7b0152611d3701525f81816106820152818161070201528181610b3a01528181610d3201528181610db2015281816111d201528181611622015281816116fa015281816117ab0152818161190e01528181611b3001528181611bb001528181611e8c0152818161219a015281816123cb015281816125900152612610015261363b5ff3fe608060405234801561000f575f80fd5b5060043610610194575f3560e01c806301ffc9a71461019857806306fdde03146101c0578063081812fc146101d5578063095ea7b3146101f557806318e9d4aa1461020a5780631bdff4f01461021557806323b872dd1461022857806324dd28ef1461023b5780633b87ee691461026b5780633ccfd60b1461027e57806342842e0e1461028657806342966c68146102995780634a1d3481146102ac5780634f15fc06146102bf5780635b7baf64146102e55780635c975abb146102f85780636352211e1461030257806363fed9a41461031557806370a0823114610335578063838c491a146103485780638e75e4821461035b57806395d89b411461036357806398049dbd1461036b5780639b48ac971461037e578063a22cb46514610391578063a934f0d2146103a4578063b6974b8d146103b7578063b87ea8d4146103bf578063b88d4fde146103c7578063c3cbf819146103da578063c87b56dd146103ed578063d688c59014610400578063d6c7527814610413578063e985e9c514610426575b5f80fd5b6101ab6101a6366004612b62565b610439565b60405190151581526020015b60405180910390f35b6101c8610449565b6040516101b79190612bca565b6101e86101e3366004612bdc565b6104d9565b6040516101b79190612bf3565b610208610203366004612c1b565b6104fe565b005b60045460ff166101ab565b610208610223366004612bdc565b610617565b610208610236366004612c45565b61064e565b7f00000000000000000000000000000000000000000000000000000000000000005b6040519081526020016101b7565b610208610279366004612c83565b610680565b610208610a7d565b610208610294366004612c45565b610cb1565b6102086102a7366004612bdc565b610ccb565b61025d6102ba366004612bdc565b610cfc565b7f000000000000000000000000000000000000000000000000000000000000000061025d565b6102086102f3366004612bdc565b610d30565b5f5460ff166101ab565b6101e8610310366004612bdc565b610f89565b610328610323366004612bdc565b610fbd565b6040516101b79190612d3c565b61025d610343366004612db2565b61114c565b610208610356366004612db2565b6111d0565b61025d6113e3565b6101c86113f9565b610208610379366004612dcd565b611408565b61020861038c366004612ded565b61144c565b61020861039f366004612e43565b61151c565b6102086103b2366004612bdc565b611527565b60035461025d565b6102086115e9565b6102086103d5366004612e83565b611a41565b6102086103e8366004612f5b565b611a79565b6101c86103fb366004612bdc565b611abe565b61020861040e366004612c1b565b611b2e565b610208610421366004612bdc565b611d35565b6101ab610434366004612f8d565b611d68565b5f61044382611d95565b92915050565b60606006805461045890612fb9565b80601f016020809104026020016040519081016040528092919081815260200182805461048490612fb9565b80156104cf5780601f106104a6576101008083540402835291602001916104cf565b820191905f5260205f20905b8154815290600101906020018083116104b257829003601f168201915b5050505050905090565b5f6104e382611de4565b505f908152600a60205260409020546001600160a01b031690565b5f61050882610f89565b9050806001600160a01b0316836001600160a01b03160361057a5760405162461bcd60e51b815260206004820152602160248201527f4552433732313a20617070726f76616c20746f2063757272656e74206f776e656044820152603960f91b60648201526084015b60405180910390fd5b336001600160a01b038216148061059657506105968133611d68565b6106085760405162461bcd60e51b815260206004820152603e60248201527f4552433732313a20617070726f76652063616c6c6572206973206e6f7420746f60448201527f6b656e206f776e6572206e6f7220617070726f76656420666f7220616c6c00006064820152608401610571565b6106128383611e09565b505050565b7f000000000000000000000000000000000000000000000000000000000000000061064181611e76565b61064a82611f2e565b5050565b610659335b82611f7f565b6106755760405162461bcd60e51b815260040161057190612ff1565b610612838383611fdd565b7f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031663b77460866040518163ffffffff1660e01b8152600401602060405180830381865afa1580156106dc573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610700919061303f565b7f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316635f8d96de6040518163ffffffff1660e01b8152600401602060405180830381865afa15801561075c573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610780919061303f565b61078a8282612162565b610792612198565b61079a612238565b5f6107a4600e5490565b90505f8481600d81898482816107bc576107bc613056565b9050602002013581526020019081526020015f2090505f6001600160a01b0316896001600160a01b031614806107f35750600f5482115b8061081357505f8888828161080a5761080a613056565b90506020020135145b806108235750600181015460ff16155b156108415760405163f250421560e01b815260040160405180910390fd5b805460015b838110156108d1575f8a8a8381811061086157610861613056565b90506020020135036108865760405163f250421560e01b815260040160405180910390fd5b600d5f8b8b8481811061089b5761089b613056565b9050602002013581526020019081526020015f205f0154826108bd919061307e565b9150806108c981613091565b915050610846565b506040516323b872dd60e01b81526001600160a01b037f000000000000000000000000000000000000000000000000000000000000000016906323b872dd90610922908d90309086906004016130a9565b6020604051808303815f875af115801561093e573d5f803e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061096291906130cd565b93508315610a5857610978600e80546001019055565b6109de8a868c8c8c5f81811061099057610990613056565b905060200201356040516020016109ca92919060609290921b6001600160601b0319168252600160fd1b6014830152601582015260350190565b60405160208183030381529060405261227d565b5f858152600c6020526040812082905560018054839290610a0090849061307e565b90915550899050885f81610a1657610a16613056565b905060200201358a6001600160a01b03165f805160206135e683398151915283885f8e8e604051610a4b959493929190613118565b60405180910390a3610a71565b604051635ea8c91160e11b815260040160405180910390fd5b50505050505050505050565b610a85612198565b60025460ff16610aa85760405163461dad3360e01b815260040160405180910390fd5b6040516370a0823160e01b81525f906001600160a01b037f000000000000000000000000000000000000000000000000000000000000000016906370a0823190610af6903090600401612bf3565b602060405180830381865afa158015610b11573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610b35919061303f565b90505f7f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316638da5cb5b6040518163ffffffff1660e01b8152600401602060405180830381865afa158015610b94573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610bb8919061314a565b90505f7f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031663a9059cbb83856040518363ffffffff1660e01b8152600401610c09929190613165565b6020604051808303815f875af1158015610c25573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610c4991906130cd565b905080610c69576040516301c6e79f60e31b815260040160405180910390fd5b816001600160a01b03167ff4f855c53853d0277a9ff688aadbfe4cb795ca1d5af41704b62cb539f89939ec84604051610ca491815260200190565b60405180910390a2505050565b61061283838360405180602001604052805f815250611a41565b610cd433610653565b610cf05760405162461bcd60e51b815260040161057190612ff1565b610cf9816122af565b50565b5f8181526005602052604081205490819003610d2b576040516339056a7960e11b815260040160405180910390fd5b919050565b7f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031663b77460866040518163ffffffff1660e01b8152600401602060405180830381865afa158015610d8c573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610db0919061303f565b7f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316635f8d96de6040518163ffffffff1660e01b8152600401602060405180830381865afa158015610e0c573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610e30919061303f565b610e3a8282612162565b610e42612198565b610e4a612238565b5f838152600c602052604081205490819003610e7c5760405163f2c7776b60e01b815260048101859052602401610571565b5f848152600c6020526040812055610e9384610ccb565b60405163a9059cbb60e01b81525f906001600160a01b037f0000000000000000000000000000000000000000000000000000000000000000169063a9059cbb90610ee39033908690600401613165565b6020604051808303815f875af1158015610eff573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610f2391906130cd565b905080610f4357604051635ea8c91160e11b815260040160405180910390fd5b6040805186815260208101849052338183015290517ff58965c0ecab72de15cc9f4ded64898d9deb1a2f1a7acdf867187295e5dfaf129181900360600190a15050505050565b5f818152600860205260408120546001600160a01b0316806104435760405162461bcd60e51b81526004016105719061317e565b610fef6040518060a001604052805f81526020015f151581526020016060815260200160608152602001606081525090565b5f828152600d6020526040812054900361101c5760405163f250421560e01b815260040160405180910390fd5b5f828152600d6020908152604091829020825160a08101845281548152600182015460ff161515818401526002820180548551818602810186018752818152929593949386019383018282801561109057602002820191905f5260205f20905b81548152602001906001019080831161107c575b50505050508152602001600382018054806020026020016040519081016040528092919081815260200182805480156110e657602002820191905f5260205f20905b8154815260200190600101908083116110d2575b505050505081526020016004820180548060200260200160405190810160405280929190818152602001828054801561113c57602002820191905f5260205f20905b815481526020019060010190808311611128575b5050505050815250509050919050565b5f6001600160a01b0382166111b55760405162461bcd60e51b815260206004820152602960248201527f4552433732313a2061646472657373207a65726f206973206e6f7420612076616044820152683634b21037bbb732b960b91b6064820152608401610571565b506001600160a01b03165f9081526009602052604090205490565b7f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031663b77460866040518163ffffffff1660e01b8152600401602060405180830381865afa15801561122c573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190611250919061303f565b61125981612333565b611261612198565b611269612238565b6040516323b872dd60e01b8152670de0b6b3a7640000905f906001600160a01b037f000000000000000000000000000000000000000000000000000000000000000016906323b872dd906112c5908790309087906004016130a9565b6020604051808303815f875af11580156112e1573d5f803e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061130591906130cd565b90508061132557604051635ea8c91160e11b815260040160405180910390fd5b5f61132f600e5490565b905061133f600e80546001019055565b6040516001600160601b0319606087901b1660208201526f205072654c61756e6368506c6564676560801b603482015261137f90869083906044016109ca565b8260015f828254611390919061307e565b9091555050604080515f808252602082019283905290916001600160a01b038816905f805160206135e6833981519152906113d3908890879060019088906131b0565b60405180910390a3505050505050565b5f6001546003546113f4919061307e565b905090565b60606007805461045890612fb9565b7f000000000000000000000000000000000000000000000000000000000000000061143281611e76565b61143a612198565b611442612238565b610612838361235f565b6114546123bf565b61145c612198565b611464612238565b5f828152600d602052604090208054158015906114845750600281015415155b8015611497575060038101546002820154145b80156114aa575060048101546002820154145b15611503575f838152600d6020526040902082906114c882826132d4565b5050600f80546001019055827fa6864d8b46e61658af68625abbf4f1c97edf49023db0d312436d31785ca2ff1c83604051610ca49190613415565b60405163f250421560e01b815260040160405180910390fd5b61064a338383612470565b61152f6123bf565b611537612198565b61153f612238565b5f818152600d6020526040812054900361156c5760405163f250421560e01b815260040160405180910390fd5b5f818152600d6020526040812081815560018101805460ff19169055906115966002830182612b1f565b6115a3600383015f612b1f565b6115b0600483015f612b1f565b50506115bc600f612539565b60405181907fa4d004a510bc90c037e1543a5a00bd7e821edb25d77b197de1fef2cfd6a8016f905f90a250565b6115f1612198565b6115f961258d565b611616576040516373140aaf60e11b815260040160405180910390fd5b5f60015490505f6127107f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031663cd3f29e96040518163ffffffff1660e01b8152600401602060405180830381865afa15801561167c573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906116a0919061303f565b6116aa908461322c565b6116b491906134bf565b604051632202a57d60e01b81527f000000000000000000000000000000000000000000000000000000000000000060048201529091505f90612710906001600160a01b037f00000000000000000000000000000000000000000000000000000000000000001690632202a57d90602401602060405180830381865afa15801561173f573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190611763919061303f565b61176d908561322c565b61177791906134bf565b90505f7f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031663a9059cbb7f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03166329c0908e6040518163ffffffff1660e01b8152600401602060405180830381865afa158015611805573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190611829919061314a565b856040518363ffffffff1660e01b8152600401611847929190613165565b6020604051808303815f875af1158015611863573d5f803e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061188791906130cd565b9050806118a7576040516301c6e79f60e31b815260040160405180910390fd5b60405163b97a598560e01b81527f000000000000000000000000000000000000000000000000000000000000000060048201526001600160a01b037f000000000000000000000000000000000000000000000000000000000000000081169163a9059cbb917f0000000000000000000000000000000000000000000000000000000000000000169063b97a598590602401602060405180830381865afa158015611953573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190611977919061314a565b846040518363ffffffff1660e01b8152600401611995929190613165565b6020604051808303815f875af11580156119b1573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906119d591906130cd565b9050806119f5576040516301c6e79f60e31b815260040160405180910390fd5b6002805460ff1916600117905560408051848152602081018490527f3e91f3ff83f723a487fba37bbc49f308f1f208eca1f92456788dd9fedab56635910160405180910390a150505050565b611a4b3383611f7f565b611a675760405162461bcd60e51b815260040161057190612ff1565b611a7384848484612694565b50505050565b7f0000000000000000000000000000000000000000000000000000000000000000611aa381611e76565b611aab612198565b611ab3612238565b611a738484846126c7565b6060611ac982611de4565b5f611ade60408051602081019091525f815290565b90505f815111611afc5760405180602001604052805f815250611b27565b80611b0684612762565b604051602001611b179291906134d2565b6040516020818303038152906040525b9392505050565b7f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031663b77460866040518163ffffffff1660e01b8152600401602060405180830381865afa158015611b8a573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190611bae919061303f565b7f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316635f8d96de6040518163ffffffff1660e01b8152600401602060405180830381865afa158015611c0a573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190611c2e919061303f565b611c388282612162565b611c40612198565b611c48612238565b6040516323b872dd60e01b81525f906001600160a01b037f000000000000000000000000000000000000000000000000000000000000000016906323b872dd90611c9a908890309089906004016130a9565b6020604051808303815f875af1158015611cb6573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190611cda91906130cd565b90508015610a58578360015f828254611cf3919061307e565b9091555050604080515f808252602082019283905290916001600160a01b038816905f805160206135e6833981519152906113d39089908590819088906131b0565b7f0000000000000000000000000000000000000000000000000000000000000000611d5f81611e76565b61064a8261285e565b6001600160a01b039182165f908152600b6020908152604080832093909416825291909152205460ff1690565b5f6001600160e01b031982166380ac58cd60e01b1480611dc557506001600160e01b03198216635b5e139f60e01b145b8061044357506301ffc9a760e01b6001600160e01b0319831614610443565b611ded816128a1565b610cf95760405162461bcd60e51b81526004016105719061317e565b5f818152600a6020526040902080546001600160a01b0319166001600160a01b0384169081179091558190611e3d82610f89565b6001600160a01b03167f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b92560405160405180910390a45050565b60405163b97a598560e01b8152600481018290527f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03169063b97a598590602401602060405180830381865afa158015611ed9573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190611efd919061314a565b6001600160a01b0316336001600160a01b031614610cf957604051632050748160e11b815260040160405180910390fd5b611f36612238565b5f805460ff191660011790556040517fc343aefb875672fb1857ecda2bdf9fa822ff1e924e3714f6a3d88c5199dee26190611f749033908490613165565b60405180910390a150565b5f80611f8a83610f89565b9050806001600160a01b0316846001600160a01b03161480611fb15750611fb18185611d68565b80611fd55750836001600160a01b0316611fca846104d9565b6001600160a01b0316145b949350505050565b826001600160a01b0316611ff082610f89565b6001600160a01b0316146120545760405162461bcd60e51b815260206004820152602560248201527f4552433732313a207472616e736665722066726f6d20696e636f72726563742060448201526437bbb732b960d91b6064820152608401610571565b6001600160a01b0382166120b65760405162461bcd60e51b8152602060048201526024808201527f4552433732313a207472616e7366657220746f20746865207a65726f206164646044820152637265737360e01b6064820152608401610571565b6120c05f82611e09565b6001600160a01b0383165f9081526009602052604081208054600192906120e8908490613500565b90915550506001600160a01b0382165f90815260096020526040812080546001929061211590849061307e565b90915550505f8181526008602052604080822080546001600160a01b0319166001600160a01b0386811691821790925591518493918716915f805160206135c683398151915291a4505050565b428281108061217057508181115b156106125760405163406e62e960e01b81526004810184905260248101839052604401610571565b7f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316635c975abb6040518163ffffffff1660e01b8152600401602060405180830381865afa1580156121f4573d5f803e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061221891906130cd565b1561223657604051638a7e0d3b60e01b815260040160405180910390fd5b565b5f5460ff16156122365760405162461bcd60e51b815260206004820152601060248201526f14185d5cd8589b194e881c185d5cd95960821b6044820152606401610571565b61228783836128bd565b6122935f8484846129da565b6106125760405162461bcd60e51b815260040161057190613513565b5f6122b982610f89565b90506122c55f83611e09565b6001600160a01b0381165f9081526009602052604081208054600192906122ed908490613500565b90915550505f8281526008602052604080822080546001600160a01b0319169055518391906001600160a01b038416905f805160206135c6833981519152908390a45050565b428181101561064a576040516370e3721360e01b81526004810183905260248101829052604401610571565b5f8281526005602052604081208290556003805483929061238190849061307e565b909155505060405181815282907fbdfd6f6d609fb52f76b8e3eb9aeee71fd2f3b833acafac6885c4b61f2c99f2c09060200160405180910390a25050565b336001600160a01b03167f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316638da5cb5b6040518163ffffffff1660e01b8152600401602060405180830381865afa158015612425573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190612449919061314a565b6001600160a01b03161461223657604051632050748160e11b815260040160405180910390fd5b816001600160a01b0316836001600160a01b0316036124cd5760405162461bcd60e51b815260206004820152601960248201527822a9219b99189d1030b8383937bb32903a379031b0b63632b960391b6044820152606401610571565b6001600160a01b038381165f818152600b6020908152604080832094871680845294825291829020805460ff191686151590811790915591519182527f17307eab39ab6107e8899845ad3d59bd9653f200f220920489ca2b5937696c31910160405180910390a3505050565b8054806125865760405162461bcd60e51b815260206004820152601b60248201527a436f756e7465723a2064656372656d656e74206f766572666c6f7760281b6044820152606401610571565b5f19019055565b5f7f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316635f410b226040518163ffffffff1660e01b8152600401602060405180830381865afa1580156125ea573d5f803e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061260e919061303f565b7f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031663e5f620b36040518163ffffffff1660e01b8152600401602060405180830381865afa15801561266a573d5f803e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061268e919061303f565b11905090565b61269f848484611fdd565b6126ab848484846129da565b611a735760405162461bcd60e51b815260040161057190613513565b60045460ff1615156001036126ef57604051630185fc5b60e41b815260040160405180910390fd5b8261270d576040516328e0e27360e21b815260040160405180910390fd5b6004805460ff19166001179055604080518415158152602081018490529081018290527fb521f40d2f82a903de9437c882619423de0ba6ec75f821df6a1850c51a8b158c9060600160405180910390a1505050565b6060815f036127885750506040805180820190915260018152600360fc1b602082015290565b815f5b81156127b1578061279b81613091565b91506127aa9050600a836134bf565b915061278b565b5f816001600160401b038111156127ca576127ca612e6f565b6040519080825280601f01601f1916602001820160405280156127f4576020820181803683370190505b5090505b8415611fd557612809600183613500565b9150612816600a86613565565b61282190603061307e565b60f81b81838151811061283657612836613056565b60200101906001600160f81b03191690815f1a905350612857600a866134bf565b94506127f8565b612866612ad7565b5f805460ff191690556040517fc8ad0281bc86c10834104cffa2f5420fc4e05ceaac799359ab370c2ff2d3afc090611f749033908490613165565b5f908152600860205260409020546001600160a01b0316151590565b6001600160a01b0382166129135760405162461bcd60e51b815260206004820181905260248201527f4552433732313a206d696e7420746f20746865207a65726f20616464726573736044820152606401610571565b61291c816128a1565b156129685760405162461bcd60e51b815260206004820152601c60248201527b115490cdcc8c4e881d1bdad95b88185b1c9958591e481b5a5b9d195960221b6044820152606401610571565b6001600160a01b0382165f90815260096020526040812080546001929061299090849061307e565b90915550505f8181526008602052604080822080546001600160a01b0319166001600160a01b03861690811790915590518392905f805160206135c6833981519152908290a45050565b5f6001600160a01b0384163b15612acc57604051630a85bd0160e11b81526001600160a01b0385169063150b7a0290612a1d903390899088908890600401613578565b6020604051808303815f875af1925050508015612a57575060408051601f3d908101601f19168201909252612a54918101906135aa565b60015b612ab2573d808015612a84576040519150601f19603f3d011682016040523d82523d5f602084013e612a89565b606091505b5080515f03612aaa5760405162461bcd60e51b815260040161057190613513565b805181602001fd5b6001600160e01b031916630a85bd0160e11b149050611fd5565b506001949350505050565b5f5460ff166122365760405162461bcd60e51b815260206004820152601460248201527314185d5cd8589b194e881b9bdd081c185d5cd95960621b6044820152606401610571565b5080545f8255905f5260205f2090810190610cf991905b80821115612b49575f8155600101612b36565b5090565b6001600160e01b031981168114610cf9575f80fd5b5f60208284031215612b72575f80fd5b8135611b2781612b4d565b5f5b83811015612b97578181015183820152602001612b7f565b50505f910152565b5f8151808452612bb6816020860160208601612b7d565b601f01601f19169290920160200192915050565b602081525f611b276020830184612b9f565b5f60208284031215612bec575f80fd5b5035919050565b6001600160a01b0391909116815260200190565b6001600160a01b0381168114610cf9575f80fd5b5f8060408385031215612c2c575f80fd5b8235612c3781612c07565b946020939093013593505050565b5f805f60608486031215612c57575f80fd5b8335612c6281612c07565b92506020840135612c7281612c07565b929592945050506040919091013590565b5f805f60408486031215612c95575f80fd5b8335612ca081612c07565b925060208401356001600160401b0380821115612cbb575f80fd5b818601915086601f830112612cce575f80fd5b813581811115612cdc575f80fd5b8760208260051b8501011115612cf0575f80fd5b6020830194508093505050509250925092565b5f8151808452602080850194508084015f5b83811015612d3157815187529582019590820190600101612d15565b509495945050505050565b60208152815160208201526020820151151560408201525f604083015160a06060840152612d6d60c0840182612d03565b90506060840151601f1980858403016080860152612d8b8383612d03565b925060808601519150808584030160a086015250612da98282612d03565b95945050505050565b5f60208284031215612dc2575f80fd5b8135611b2781612c07565b5f8060408385031215612dde575f80fd5b50508035926020909101359150565b5f8060408385031215612dfe575f80fd5b8235915060208301356001600160401b03811115612e1a575f80fd5b830160a08186031215612e2b575f80fd5b809150509250929050565b8015158114610cf9575f80fd5b5f8060408385031215612e54575f80fd5b8235612e5f81612c07565b91506020830135612e2b81612e36565b634e487b7160e01b5f52604160045260245ffd5b5f805f8060808587031215612e96575f80fd5b8435612ea181612c07565b93506020850135612eb181612c07565b92506040850135915060608501356001600160401b0380821115612ed3575f80fd5b818701915087601f830112612ee6575f80fd5b813581811115612ef857612ef8612e6f565b604051601f8201601f19908116603f01168101908382118183101715612f2057612f20612e6f565b816040528281528a6020848701011115612f38575f80fd5b826020860160208301375f60208483010152809550505050505092959194509250565b5f805f60608486031215612f6d575f80fd5b8335612f7881612e36565b95602085013595506040909401359392505050565b5f8060408385031215612f9e575f80fd5b8235612fa981612c07565b91506020830135612e2b81612c07565b600181811c90821680612fcd57607f821691505b602082108103612feb57634e487b7160e01b5f52602260045260245ffd5b50919050565b6020808252602e908201527f4552433732313a2063616c6c6572206973206e6f7420746f6b656e206f776e6560408201526d1c881b9bdc88185c1c1c9bdd995960921b606082015260800190565b5f6020828403121561304f575f80fd5b5051919050565b634e487b7160e01b5f52603260045260245ffd5b634e487b7160e01b5f52601160045260245ffd5b808201808211156104435761044361306a565b5f600182016130a2576130a261306a565b5060010190565b6001600160a01b039384168152919092166020820152604081019190915260600190565b5f602082840312156130dd575f80fd5b8151611b2781612e36565b8183525f6001600160fb1b038311156130ff575f80fd5b8260051b80836020870137939093016020019392505050565b8581528460208201528315156040820152608060608201525f61313f6080830184866130e8565b979650505050505050565b5f6020828403121561315a575f80fd5b8151611b2781612c07565b6001600160a01b03929092168252602082015260400190565b602080825260189082015277115490cdcc8c4e881a5b9d985b1a59081d1bdad95b88125160421b604082015260600190565b8481528360208201528215156040820152608060608201525f6131d66080830184612d03565b9695505050505050565b5f808335601e198436030181126131f5575f80fd5b8301803591506001600160401b0382111561320e575f80fd5b6020019150600581901b3603821315613225575f80fd5b9250929050565b80820281158282048414176104435761044361306a565b6001600160401b0383111561325a5761325a612e6f565b600160401b83111561326e5761326e612e6f565b8054838255808410156132a4575f828152602081208581019083015b808210156132a05782825560018201915061328a565b5050505b505f8181526020812083915b858110156132cc578235828201556020909201916001016132b0565b505050505050565b8135815560018082016020808501356132ec81612e36565b825490151560ff1660ff199190911617909155600283019061331160408601866131e0565b6001600160401b0381111561332857613328612e6f565b600160401b81111561333c5761333c612e6f565b83548185558082101561336f575f8581528481208381019083015b8082101561336b5782825590880190613357565b5050505b505f93845260208420935b818110156133935782358582015591830191850161337a565b5050505050506133a660608301836131e0565b6133b4818360038601613243565b50506133c360808301836131e0565b611a73818360048601613243565b5f808335601e198436030181126133e6575f80fd5b83016020810192503590506001600160401b03811115613404575f80fd5b8060051b3603821315613225575f80fd5b60208152813560208201525f602083013561342f81612e36565b80151560408401525061344560408401846133d1565b60a0606085015261345a60c0850182846130e8565b91505061346a60608501856133d1565b601f19808685030160808701526134828483856130e8565b935061349160808801886133d1565b93509150808685030160a0870152506131d68383836130e8565b634e487b7160e01b5f52601260045260245ffd5b5f826134cd576134cd6134ab565b500490565b5f83516134e3818460208801612b7d565b8351908301906134f7818360208801612b7d565b01949350505050565b818103818111156104435761044361306a565b60208082526032908201527f4552433732313a207472616e7366657220746f206e6f6e20455243373231526560408201527131b2b4bb32b91034b6b83632b6b2b73a32b960711b606082015260800190565b5f82613573576135736134ab565b500690565b6001600160a01b03858116825284166020820152604081018390526080606082018190525f906131d690830184612b9f565b5f602082840312156135ba575f80fd5b8151611b2781612b4d56feddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef20dd0f74bb8be0abb537cbe06c2af04a63bf6f8d95971dacc7d6f627e28b9caba264697066735822122026019495420db713213bfdf4f0933657edf6c6c2a157b7a548757a3795ac6cae64736f6c63430008140033");

  const result = await addBytecode.wait();
  console.log(result);

  // const createCampaign = await campaignInfoFactory.createCampaign(
  //   owner.address,
  //   "0xcc7b0ace0b803eb8476b3fb1e74a99df7d3209dfcf42790d24b519e108574dad",
  //   platforms,
  //   emptyBytes32Array,
  //   emptyBytes32Array,
  //   campaignData
  // );

  console.log(
    "NEXT_PUBLIC_GLOBAL_PARAMS=" +
      globalParams.address +
      "\nNEXT_PUBLIC_CAMPAIGN_INFO_FACTORY=" +
      campaignInfoFactory.address +
      "\nNEXT_PUBLIC_TREASURY_FACTORY=" +
      treasuryFactory.address,
    "\nNEXT_PUBLIC_TEST_USD=" + testUSD.address,
    "\nNEXT_PUBLIC_ITEM_REGISTRY=" + itemRegistry.address
  );
}

// We recommend this pattern to be able to use async/await everywhere
// and properly handle errors.
main().catch((error) => {
  console.error(error);
  process.exitCode = 1;
});
